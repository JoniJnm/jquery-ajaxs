/*!
 * Send jQuery ajax requests one by one or pararell
 * https://github.com/JoniJnm/jquery-ajaxs
 *
 * Copyright JoniJnm.es
 * Released under the GPL-2.0 license.
 *
 * Date: 2015-11-16
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e=function(e,s){for(var i in s)s.hasOwnProperty(i)&&(this[i]=s[i]);if(this.ajaxs=e,this.total=e.length,0===this.total)throw this.aborted=!0,new Error("Ajaxs empty");this.maxParallel<=0&&(this.maxParallel=this.total),this.aborted=!1,this.current=null,this.defer=t.Deferred(),this.i=0,this.dones=0,this.calls=[]};e.prototype={run:function(){for(var t=0;t<this.maxParallel&&t<this.total;t++)this.nextAjax();return this.defer.promise(this.promiseExtend())},onDoneAjax:function(){this.dones++,this.dones===this.total?this.defer.resolve.apply(this.defer,arguments):this.nextAjax()},nextAjax:function(){var t=this.i++;t<this.total&&this.createAjax(t)},createAjax:function(e){var s=this.ajaxs[e];this.current=t.ajax(s),this.calls.push(this.current),this.current.then(this.onDoneAjax.bind(this),this.defer.reject.bind(this.defer)),this.aborted&&this.current.abort()},abort:function(){this.aborted=!0,this.current&&this.current.abort();for(var t=0;t<this.calls.length;t++)this.calls[t].abort()},promiseExtend:function(){var t=this;return{abort:function(){return t.abort(),this}}}};var s={maxParallel:1},i=function(e){this.settings=t.extend(!0,{},s,e),this.ajaxs=[],this.aborted=!1,this.promise=null};i.prototype={setMaxParallel:function(t){return this.settings.maxParallel=t,this},add:function(t){return this.ajaxs.push(t),this},abort:function(){return this.aborted?this:(this.aborted=!0,this.promise&&this.promise.abort(),this)},run:function(){return this.promise?this:(this.promise=t.ajaxs(this.ajaxs,this.settings),this.aborted&&this.promise.abort(),this.promise)}},t.ajaxs=function(i,r){r=t.extend(!0,{},s,r);var a=new e(i,r);return a.run()},t.ajaxsManager=function(){return new i}});