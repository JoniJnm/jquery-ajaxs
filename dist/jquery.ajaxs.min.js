/*!
 * Send jQuery ajax requests one by one or pararell
 * https://github.com/JoniJnm/jquery-ajaxs
 *
 * Copyright JoniJnm.es
 * Released under the GPL-2.0 license.
 *
 * Date: 2015-11-02
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e=function(t){this.ajaxs=t,this.total=t.length,this.aborted=!1};e.prototype={promiseExtend:function(){var t=this;return{abort:function(){return t.abort(),this}}},abort:function(){this.aborted=!0},run:function(){}};var r=e.prototype,s=function(){e.apply(this,arguments),this.current=null,this.defer=t.Deferred()};s.prototype={abort:function(){r.abort.apply(this,arguments),this.current.abort()},run:function(){return r.run.apply(this,arguments),this.createAjax(0),this.defer.promise(this.promiseExtend())},createAjax:function(e){var r=this.ajaxs[e];if(e+1===this.total)this.current=t.ajax(r),this.current.then(this.defer.resolve,this.defer.reject);else{var s=this;this.current=t.ajax(r),this.current.then(function(){s.createAjax(e+1)},this.defer.reject)}this.aborted&&this.current.abort()}},s.prototype=t.extend(Object.create(r),s.prototype);var n=function(){e.apply(this,arguments),this.calls=[]};n.prototype={abort:function(){r.abort.apply(this,arguments);for(var t=0;t<this.calls.length;t++)this.calls[t].abort()},run:function(){r.run.apply(this,arguments);for(var e=0;e<this.total;e++){var s=this.ajaxs[e];this.calls.push(t.ajax(s))}return t.when.apply(t,this.calls).promise(this.promiseExtend())}},n.prototype=t.extend(Object.create(r),n.prototype);var i={mode:"onebyone"},o=function(e){this.settings=t.extend(!0,{},i,e),this.ajaxs=[],this.aborted=!1,this.promise=null};o.prototype={setParallel:function(){return this.settings.mode="parallel",this},setOnebyone:function(){return this.settings.mode="onebyone",this},add:function(t){return this.ajaxs.push(t),this},abort:function(){return this.aborted?this:(this.aborted=!0,this.promise&&this.promise.abort(),this)},run:function(){return this.promise?this:(this.promise=t.ajaxs(this.ajaxs,this.settings),this.aborted&&this.promise.abort(),this.promise)}},t.ajaxs=function(e,r){r=t.extend(!0,{},i,r);var o;return o="parallel"===r.mode?new n(e):new s(e),o.run()},t.ajaxsManager=function(){return new o}});